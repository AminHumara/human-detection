# Детекция людей в видео с использованием YOLOv8

Этот проект выполняет детекцию людей на видео `crowd.mp4` с использованием модели YOLOv8 и сохраняет результат с отрисованными bounding boxes.

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/AminHumara/human-detection.git
   cd crowd_detection
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Поместите видеофайл crowd.mp4 в директорию input/.

4. Убедитесь, что модель yolov8n.pt доступна (будет автоматически загружена YOLOv8 при первом запуске, если не указан локальный путь).

## Запуск

```bash
   pip install -r requirements.txt
   ```
Результат будет сохранен в output/processed_crowd.mp4.

## Требования

* Python 3.8+
* Операционные системы: Linux, MacOS, Windows

## Структура проекта  
* main.py - Основной скрипт с логикой обработки.
* input/ - Директория для входного видео.
* output/ - Директория для выходного видео.
* requirements.txt - Список зависимостей.
* README.md - Документация.

## Примечания 
* Видео должно быть в формате MP4.
* Отрисовка включает имя класса ("Человек") и уверенность модели.

  
### Анализ результатов и шаги по улучшению

#### Результаты
После обработки видео `crowd.mp4` с помощью YOLOv8n:
1. **Качество детекции**: Модель успешно обнаруживает большую часть людей в кадре, особенно в условиях хорошего освещения и при средней плотности толпы.
2. **Проблемы**:
   - Пропуски в густой толпе из-за перекрытий.
   - Ложные срабатывания на объектах, похожих на людей (например, картина в правом углу).
   - Низкая точность при плохом освещении или на большом расстоянии.

#### Шаги по улучшению
1. **Использование более тяжелой модели**:
   - Перейти с `yolov8n` (nano) на `yolov8m` или `yolov8l` для повышения точности за счет увеличения вычислительной нагрузки.
2. **Дообучение модели**:
   - Собрать датасет с кадрами из толпы в разных условиях и дообучить модель на этих данных.
3. **Постобработка**:
   - Добавить трекинг (например, с помощью DeepSORT), чтобы уменьшить пропуски и связать людей между кадрами.
4. **Оптимизация условий**:
   - Применить предобработку кадров (увеличение контраста, нормализация освещения) для улучшения детекции в сложных условиях.

### Инструкция по воспроизведению
1. Установите зависимости из `requirements.txt`.
2. Поместите `crowd.mp4` в `input/`.
3. Запустите `python main.py`.
4. Проверьте результат в `output/processed_crowd.mp4`.
